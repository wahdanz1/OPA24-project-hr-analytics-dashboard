{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-26T13:56:09.841379Z", "invocation_id": "4590a63b-2eb0-424d-b5c2-1c43b5d5349f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.732873Z", "completed_at": "2025-05-26T13:56:09.734949Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.735951Z", "completed_at": "2025-05-26T13:56:09.735951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004084348678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_duplicate_primary_keys", "compiled": true, "compiled_code": "-- Ensures no duplicate primary keys exist in key models,\n-- which could compromise downstream joins and analysis.\n\nSELECT \n    id, \n    COUNT(*) \nFROM \"job_ads\".\"staging\".\"job_ads\" \nGROUP BY id \nHAVING COUNT(*) > 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.737483Z", "completed_at": "2025-05-26T13:56:09.740712Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.741215Z", "completed_at": "2025-05-26T13:56:09.741215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004237651824951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_missing_employer_name", "compiled": true, "compiled_code": "-- Flags records where `employer_name` is missing\n-- or null \u2014 important for attribution and insights.\n\nSELECT\n    *\nFROM \"job_ads\".\"staging\".\"job_ads\"\nWHERE TRIM(employer__name) = '' OR employer__name IS NULL", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.742718Z", "completed_at": "2025-05-26T13:56:09.756988Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.757495Z", "completed_at": "2025-05-26T13:56:09.757495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015278100967407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_aux", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_aux as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT\n    experience_required,\n    driving_license_required AS driver_license,\n    access_to_own_car\nFROM stg_job_ads\n), src_aux AS (SELECT * FROM __dbt__cte__src_aux)\nSELECT DISTINCT\n    md5(cast(coalesce(cast(experience_required as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(driver_license as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(access_to_own_car as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS auxiliary_attributes_id,\n    experience_required,\n    driver_license,\n    access_to_own_car\nFROM\n    src_aux\nWHERE\n    experience_required IS NOT NULL\n    OR driver_license IS NOT NULL\n    OR access_to_own_car IS NOT NULL", "relation_name": "\"job_ads\".\"refined\".\"dim_aux\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.759499Z", "completed_at": "2025-05-26T13:56:09.768572Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.768572Z", "completed_at": "2025-05-26T13:56:09.768572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010076522827148438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_employer", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_employer as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT\n    employer__name AS employer_name,\n    employer__workplace AS employer_workplace,\n    employer__organization_number AS employer_org_number,\n    workplace_address__street_address AS workplace_street_address,\n    workplace_address__region AS workplace_region,\n    workplace_address__municipality AS workplace_municipality,\n    workplace_address__postcode AS workplace_postcode,\n    workplace_address__city AS workplace_city,\n    workplace_address__country AS workplace_country\nFROM stg_job_ads\n), src_employer AS (\n    SELECT * FROM __dbt__cte__src_employer\n)\n\nSELECT DISTINCT\n    md5(cast(coalesce(cast(employer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(employer_workplace as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(workplace_municipality as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS employer_id,\n\n    employer_name,\n    employer_workplace,\n    employer_org_number,\n    workplace_street_address,\n    workplace_region,\n    workplace_municipality,\n    workplace_postcode,\n    \n    upper(left(workplace_city, 1)) || lower(substring(workplace_city, 2))\n AS workplace_city,\n    workplace_country\n\nFROM src_employer", "relation_name": "\"job_ads\".\"refined\".\"dim_employer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.770591Z", "completed_at": "2025-05-26T13:56:09.782382Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.782883Z", "completed_at": "2025-05-26T13:56:09.782883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012793540954589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.fct_job_ads", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_job_ads as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    publication_date,\n    id, -- dim_job_details ID\n    occupation__label AS occupation, -- dim_occupation ID\n    employer__name AS employer_name, -- dim_employer ID\n    employer__workplace AS employer_workplace, -- dim_employer ID\n    workplace_address__municipality AS workplace_municipality, -- dim_employer ID\n    experience_required, -- dim_aux ID\n    driving_license_required AS driver_license, -- dim_aux ID\n    access_to_own_car, -- dim_aux ID\n    number_of_vacancies AS vacancies,\n    relevance, \n    application_deadline\nFROM stg_job_ads\n), fct_job_ads AS (SELECT * FROM __dbt__cte__src_job_ads)\n\nSELECT \n    publication_date,\n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS job_details_id,\n    md5(cast(coalesce(cast(occupation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS occupation_id,\n    md5(cast(coalesce(cast(employer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(employer_workplace as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(workplace_municipality as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS employer_id,\n    md5(cast(coalesce(cast(experience_required as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(driver_license as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(access_to_own_car as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS aux_id,\n    vacancies,\n    relevance, \n    application_deadline\nFROM fct_job_ads", "relation_name": "\"job_ads\".\"refined\".\"fct_job_ads\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.784772Z", "completed_at": "2025-05-26T13:56:09.788430Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.789177Z", "completed_at": "2025-05-26T13:56:09.789177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005293369293212891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_future_publication_date", "compiled": true, "compiled_code": "with __dbt__cte__src_job_ads as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    publication_date,\n    id, -- dim_job_details ID\n    occupation__label AS occupation, -- dim_occupation ID\n    employer__name AS employer_name, -- dim_employer ID\n    employer__workplace AS employer_workplace, -- dim_employer ID\n    workplace_address__municipality AS workplace_municipality, -- dim_employer ID\n    experience_required, -- dim_aux ID\n    driving_license_required AS driver_license, -- dim_aux ID\n    access_to_own_car, -- dim_aux ID\n    number_of_vacancies AS vacancies,\n    relevance, \n    application_deadline\nFROM stg_job_ads\n) -- Checks for any job ads with a publication date set in the future,\n-- which could indicate incorrect or dirty data.\n\nSELECT\n    *\nFROM __dbt__cte__src_job_ads\nWHERE CAST(publication_date AS DATE) > CURRENT_DATE", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.791178Z", "completed_at": "2025-05-26T13:56:09.796370Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.796873Z", "completed_at": "2025-05-26T13:56:09.796873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00669550895690918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_job_details", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_job_details as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    id,\n    headline,\n    description__text AS description,\n    description__text_formatted AS description_html_formatted,\n    employment_type__label AS employment_type,\n    duration__label AS duration,\n    salary_type__label AS salary_type,\n    scope_of_work__min AS scope_of_work_min,\n    scope_of_work__max AS scope_of_work_max\nFROM \n    stg_job_ads\n), src_job_details AS (SELECT * FROM __dbt__cte__src_job_details)\n\nSELECT DISTINCT\n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS job_details_id,\n    headline,\n    description,\n    description_html_formatted,\n    employment_type,\n    duration,\n    salary_type,\n    scope_of_work_min,\n    scope_of_work_max\nFROM \n    src_job_details", "relation_name": "\"job_ads\".\"refined\".\"dim_job_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.798915Z", "completed_at": "2025-05-26T13:56:09.803093Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.803595Z", "completed_at": "2025-05-26T13:56:09.803595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005700111389160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_occupation", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_occupation as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    occupation__concept_id AS occupation_id,\n    occupation__label AS occupation,\n    occupation_group__concept_id AS occupation_group_id, \n    occupation_group__label AS occupation_group,\n    occupation_field__concept_id AS occupation_field_id,\n    occupation_field__label AS occupation_field\nFROM stg_job_ads\n), src_occupation AS (SELECT * FROM __dbt__cte__src_occupation)\n\nSELECT DISTINCT\n    md5(cast(coalesce(cast(occupation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS occupation_id,\n    occupation,\n    occupation_group,\n    occupation_field\nFROM src_occupation", "relation_name": "\"job_ads\".\"refined\".\"dim_occupation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.805116Z", "completed_at": "2025-05-26T13:56:09.807635Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.808140Z", "completed_at": "2025-05-26T13:56:09.808140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003539562225341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_employer_org_number", "compiled": true, "compiled_code": "-- Validates that all employer organization numbers are exactly 10 digits,\n-- as expected by Swedish organization number standards.\n\nSELECT \n    * \nFROM \"job_ads\".\"refined\".\"dim_employer\"\nWHERE LENGTH(employer_org_number) != 10", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.810219Z", "completed_at": "2025-05-26T13:56:09.813262Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.813765Z", "completed_at": "2025-05-26T13:56:09.813765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004606723785400391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_occupation_group_vacancy_totals", "compiled": true, "compiled_code": "WITH fct AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_employer AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_employer\"\n),\n\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT\n    f.publication_date,\n    e.workplace_region,\n    e.workplace_municipality,\n    o.occupation_group,\n    o.occupation_field,\n    SUM(f.vacancies) AS total_vacancies\nFROM fct f\nJOIN dim_employer e ON e.employer_id = f.employer_id\nJOIN dim_occupation o ON o.occupation_id = f.occupation_id\nWHERE e.workplace_region IS NOT NULL\n    AND e.workplace_municipality IS NOT NULL\nGROUP BY\n    f.publication_date,\n    e.workplace_region,\n    e.workplace_municipality,\n    o.occupation_group,\n    o.occupation_field", "relation_name": "\"job_ads\".\"marts\".\"mart_occupation_group_vacancy_totals\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.814925Z", "completed_at": "2025-05-26T13:56:09.817984Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.818486Z", "completed_at": "2025-05-26T13:56:09.818486Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004218578338623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_occupation_trends_over_time", "compiled": true, "compiled_code": "WITH fct AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_aux AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_aux\"\n),\n\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT \n    fct.publication_date,\n    fct.vacancies,\n    aux.experience_required,\n    occ.occupation,\n    occ.occupation_group,\n    occ.occupation_field\nFROM fct\nJOIN dim_aux aux ON aux.auxiliary_attributes_id = fct.aux_id\nJOIN dim_occupation occ ON occ.occupation_id = fct.occupation_id", "relation_name": "\"job_ads\".\"marts\".\"mart_occupation_trends_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.820181Z", "completed_at": "2025-05-26T13:56:09.823184Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.824132Z", "completed_at": "2025-05-26T13:56:09.824132Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0044515132904052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_occupation_vacancy_totals", "compiled": true, "compiled_code": "WITH fct_job_ads AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT\n    fct_job_ads.publication_date,\n    dim_occupation.occupation,\n    dim_occupation.occupation_group,\n    dim_occupation.occupation_field,\n    SUM(fct_job_ads.vacancies) AS total_vacancies\nFROM fct_job_ads\nJOIN dim_occupation \n    ON dim_occupation.occupation_id = fct_job_ads.occupation_id\nGROUP BY\n    fct_job_ads.publication_date,\n    dim_occupation.occupation,\n    dim_occupation.occupation_group,\n    dim_occupation.occupation_field,", "relation_name": "\"job_ads\".\"marts\".\"mart_occupation_vacancy_totals\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.826196Z", "completed_at": "2025-05-26T13:56:09.828747Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.829256Z", "completed_at": "2025-05-26T13:56:09.829256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0045642852783203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_summary", "compiled": true, "compiled_code": "WITH fct AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_occ AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n),\n\ndim_aux AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_aux\"\n),\n\ndim_emp AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_employer\"\n)\n\nSELECT \n    f.publication_date,\n    f.vacancies,\n    f.relevance,\n    f.application_deadline,\n\n    -- Occupation info\n    o.occupation,\n    o.occupation_group,\n    o.occupation_field,\n\n    -- Employer info\n    e.employer_name,\n    e.employer_workplace,\n    e.workplace_municipality,\n    e.workplace_region,\n\n    -- Experience + aux info\n    a.experience_required,\n    a.driver_license,\n    a.access_to_own_car\n\nFROM fct f\nLEFT JOIN dim_occ o ON f.occupation_id = o.occupation_id\nLEFT JOIN dim_aux a ON f.aux_id = a.auxiliary_attributes_id\nLEFT JOIN dim_emp e ON f.employer_id = e.employer_id", "relation_name": "\"job_ads\".\"marts\".\"mart_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.830757Z", "completed_at": "2025-05-26T13:56:09.834205Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.834205Z", "completed_at": "2025-05-26T13:56:09.834205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003948688507080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_top_employers", "compiled": true, "compiled_code": "WITH fct_job_ads AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\ndim_employer AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_employer\"\n),\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT\n    dim_employer.employer_name,\n    dim_employer.workplace_region,\n    dim_occupation.occupation,\n    SUM(fct_job_ads.vacancies) AS total_vacancies,\nFROM fct_job_ads \nJOIN dim_employer \n    ON dim_employer.employer_id = fct_job_ads.employer_id\nJOIN dim_occupation\n    ON dim_occupation.occupation_id = fct_job_ads.occupation_id\nGROUP BY\n    dim_employer.employer_name,\n    dim_employer.workplace_region,\n    dim_occupation.occupation,\nORDER BY total_vacancies DESC", "relation_name": "\"job_ads\".\"marts\".\"mart_top_employers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T13:56:09.836261Z", "completed_at": "2025-05-26T13:56:09.838804Z"}, {"name": "execute", "started_at": "2025-05-26T13:56:09.838804Z", "completed_at": "2025-05-26T13:56:09.838804Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035467147827148438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_missing_occupation_id", "compiled": true, "compiled_code": "-- Detects rows with missing occupation identifiers,\n-- which are necessary for classification and analysis.\n\nSELECT \n    * \nFROM \"job_ads\".\"refined\".\"fct_job_ads\" f \nLEFT JOIN \"job_ads\".\"refined\".\"dim_occupation\" d\n    ON f.occupation_id = d.occupation_id \nWHERE d.occupation_id IS NULL", "relation_name": null, "batch_results": null}], "elapsed_time": 0.3076012134552002, "args": {"invocation_command": "dbt docs generate", "quiet": false, "favor_state": false, "show_resource_report": false, "version_check": true, "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "compile": true, "cache_selected_only": false, "partial_parse_file_diff": true, "profiles_dir": "C:\\Users\\dwahl\\.dbt", "static_parser": true, "write_json": true, "skip_nodes_if_on_run_start_fails": false, "select": [], "source_freshness_run_project_hooks": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "log_file_max_bytes": 10485760, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "defer": false, "strict_mode": false, "log_path": "D:\\Daniel\\Studier\\OPA24\\Kurser\\6-AI_2_Data-engineering\\OPA24-project\\job_market\\logs", "populate_cache": true, "require_resource_names_without_spaces": false, "log_format": "default", "static": false, "log_level": "info", "printer_width": 80, "require_nested_cumulative_type_params": false, "vars": {}, "send_anonymous_usage_stats": true, "which": "generate", "macro_debugging": false, "empty_catalog": false, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "project_dir": "D:\\Daniel\\Studier\\OPA24\\Kurser\\6-AI_2_Data-engineering\\OPA24-project\\job_market", "use_colors_file": true, "indirect_selection": "eager", "use_colors": true, "require_batched_execution_for_custom_microbatch_strategy": false, "print": true}}