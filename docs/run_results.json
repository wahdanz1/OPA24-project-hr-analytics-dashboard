{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-26T11:22:59.012445Z", "invocation_id": "6a4b0a05-4295-4bbe-8de5-de9948aac12d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.904683Z", "completed_at": "2025-05-26T11:22:58.907222Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.907222Z", "completed_at": "2025-05-26T11:22:58.907222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00356292724609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_duplicate_primary_keys", "compiled": true, "compiled_code": "-- Ensures no duplicate primary keys exist in key models,\n-- which could compromise downstream joins and analysis.\n\nSELECT \n    id, \n    COUNT(*) \nFROM \"job_ads\".\"staging\".\"job_ads\" \nGROUP BY id \nHAVING COUNT(*) > 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.908665Z", "completed_at": "2025-05-26T11:22:58.911656Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.912186Z", "completed_at": "2025-05-26T11:22:58.912186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003520965576171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_missing_employer_name", "compiled": true, "compiled_code": "-- Flags records where `employer_name` is missing\n-- or null \u2014 important for attribution and insights.\n\nSELECT\n    *\nFROM \"job_ads\".\"staging\".\"job_ads\"\nWHERE TRIM(employer__name) = '' OR employer__name IS NULL", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.914247Z", "completed_at": "2025-05-26T11:22:58.928423Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.929004Z", "completed_at": "2025-05-26T11:22:58.929004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015813827514648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_aux", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_aux as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT\n    experience_required,\n    driving_license_required AS driver_license,\n    access_to_own_car\nFROM stg_job_ads\n), src_aux AS (SELECT * FROM __dbt__cte__src_aux)\nSELECT DISTINCT\n    md5(cast(coalesce(cast(experience_required as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(driver_license as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(access_to_own_car as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS auxiliary_attributes_id,\n    experience_required,\n    driver_license,\n    access_to_own_car\nFROM\n    src_aux\nWHERE\n    experience_required IS NOT NULL\n    OR driver_license IS NOT NULL\n    OR access_to_own_car IS NOT NULL", "relation_name": "\"job_ads\".\"refined\".\"dim_aux\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.930949Z", "completed_at": "2025-05-26T11:22:58.938563Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.939567Z", "completed_at": "2025-05-26T11:22:58.939567Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01006317138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_employer", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_employer as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT\n    employer__name AS employer_name,\n    employer__workplace AS employer_workplace,\n    employer__organization_number AS employer_org_number,\n    workplace_address__street_address AS workplace_street_address,\n    workplace_address__region AS workplace_region,\n    workplace_address__municipality AS workplace_municipality,\n    workplace_address__postcode AS workplace_postcode,\n    workplace_address__city AS workplace_city,\n    workplace_address__country AS workplace_country\nFROM stg_job_ads\n), src_employer AS (\n    SELECT * FROM __dbt__cte__src_employer\n)\n\nSELECT DISTINCT\n    md5(cast(coalesce(cast(employer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(employer_workplace as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(workplace_municipality as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS employer_id,\n\n    employer_name,\n    employer_workplace,\n    employer_org_number,\n    workplace_street_address,\n    workplace_region,\n    workplace_municipality,\n    workplace_postcode,\n    \n    upper(left(workplace_city, 1)) || lower(substring(workplace_city, 2))\n AS workplace_city,\n    workplace_country\n\nFROM src_employer", "relation_name": "\"job_ads\".\"refined\".\"dim_employer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.941622Z", "completed_at": "2025-05-26T11:22:58.952964Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.952964Z", "completed_at": "2025-05-26T11:22:58.952964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013103485107421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.fct_job_ads", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_job_ads as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    publication_date,\n    id, -- dim_job_details ID\n    occupation__label AS occupation, -- dim_occupation ID\n    employer__name AS employer_name, -- dim_employer ID\n    employer__workplace AS employer_workplace, -- dim_employer ID\n    workplace_address__municipality AS workplace_municipality, -- dim_employer ID\n    experience_required, -- dim_aux ID\n    driving_license_required AS driver_license, -- dim_aux ID\n    access_to_own_car, -- dim_aux ID\n    number_of_vacancies AS vacancies,\n    relevance, \n    application_deadline\nFROM stg_job_ads\n), fct_job_ads AS (SELECT * FROM __dbt__cte__src_job_ads)\n\nSELECT \n    publication_date,\n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS job_details_id,\n    md5(cast(coalesce(cast(occupation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS occupation_id,\n    md5(cast(coalesce(cast(employer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(employer_workplace as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(workplace_municipality as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS employer_id,\n    md5(cast(coalesce(cast(experience_required as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(driver_license as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(access_to_own_car as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS aux_id,\n    vacancies,\n    relevance, \n    application_deadline\nFROM fct_job_ads", "relation_name": "\"job_ads\".\"refined\".\"fct_job_ads\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.955261Z", "completed_at": "2025-05-26T11:22:58.958558Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.958558Z", "completed_at": "2025-05-26T11:22:58.958558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003833293914794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_future_publication_date", "compiled": true, "compiled_code": "with __dbt__cte__src_job_ads as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    publication_date,\n    id, -- dim_job_details ID\n    occupation__label AS occupation, -- dim_occupation ID\n    employer__name AS employer_name, -- dim_employer ID\n    employer__workplace AS employer_workplace, -- dim_employer ID\n    workplace_address__municipality AS workplace_municipality, -- dim_employer ID\n    experience_required, -- dim_aux ID\n    driving_license_required AS driver_license, -- dim_aux ID\n    access_to_own_car, -- dim_aux ID\n    number_of_vacancies AS vacancies,\n    relevance, \n    application_deadline\nFROM stg_job_ads\n) -- Checks for any job ads with a publication date set in the future,\n-- which could indicate incorrect or dirty data.\n\nSELECT\n    *\nFROM __dbt__cte__src_job_ads\nWHERE CAST(publication_date AS DATE) > CURRENT_DATE", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.960999Z", "completed_at": "2025-05-26T11:22:58.965541Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.966467Z", "completed_at": "2025-05-26T11:22:58.966467Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0069048404693603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_job_details", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_job_details as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    id,\n    headline,\n    description__text AS description,\n    description__text_formatted AS description_html_formatted,\n    employment_type__label AS employment_type,\n    duration__label AS duration,\n    salary_type__label AS salary_type,\n    scope_of_work__min AS scope_of_work_min,\n    scope_of_work__max AS scope_of_work_max\nFROM \n    stg_job_ads\n), src_job_details AS (SELECT * FROM __dbt__cte__src_job_details)\n\nSELECT DISTINCT\n    md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS job_details_id,\n    headline,\n    description,\n    description_html_formatted,\n    employment_type,\n    duration,\n    salary_type,\n    scope_of_work_min,\n    scope_of_work_max\nFROM \n    src_job_details", "relation_name": "\"job_ads\".\"refined\".\"dim_job_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.967976Z", "completed_at": "2025-05-26T11:22:58.973673Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.974243Z", "completed_at": "2025-05-26T11:22:58.974243Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006769418716430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.dim_occupation", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_occupation as (\nWITH stg_job_ads AS (SELECT * FROM \"job_ads\".\"staging\".\"job_ads\")\n\nSELECT \n    occupation__concept_id AS occupation_id,\n    occupation__label AS occupation,\n    occupation_group__concept_id AS occupation_group_id, \n    occupation_group__label AS occupation_group,\n    occupation_field__concept_id AS occupation_field_id,\n    occupation_field__label AS occupation_field\nFROM stg_job_ads\n), src_occupation AS (SELECT * FROM __dbt__cte__src_occupation)\n\nSELECT DISTINCT\n    md5(cast(coalesce(cast(occupation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS occupation_id,\n    occupation,\n    occupation_group,\n    occupation_field\nFROM src_occupation", "relation_name": "\"job_ads\".\"refined\".\"dim_occupation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.976349Z", "completed_at": "2025-05-26T11:22:58.978667Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.978667Z", "completed_at": "2025-05-26T11:22:58.978667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033228397369384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_employer_org_number", "compiled": true, "compiled_code": "-- Validates that all employer organization numbers are exactly 10 digits,\n-- as expected by Swedish organization number standards.\n\nSELECT \n    * \nFROM \"job_ads\".\"refined\".\"dim_employer\"\nWHERE LENGTH(employer_org_number) != 10", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.981223Z", "completed_at": "2025-05-26T11:22:58.983729Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.984241Z", "completed_at": "2025-05-26T11:22:58.984241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004056692123413086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_occupation_group_vacancy_totals", "compiled": true, "compiled_code": "WITH fct AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_employer AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_employer\"\n),\n\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT\n    f.publication_date,\n    e.workplace_region,\n    e.workplace_municipality,\n    o.occupation_group,\n    o.occupation_field,\n    SUM(f.vacancies) AS total_vacancies\nFROM fct f\nJOIN dim_employer e ON e.employer_id = f.employer_id\nJOIN dim_occupation o ON o.occupation_id = f.occupation_id\nWHERE e.workplace_region IS NOT NULL\n    AND e.workplace_municipality IS NOT NULL\nGROUP BY\n    f.publication_date,\n    e.workplace_region,\n    e.workplace_municipality,\n    o.occupation_group,\n    o.occupation_field", "relation_name": "\"job_ads\".\"marts\".\"mart_occupation_group_vacancy_totals\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.986242Z", "completed_at": "2025-05-26T11:22:58.988769Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.988769Z", "completed_at": "2025-05-26T11:22:58.988769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035276412963867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_occupation_trends_over_time", "compiled": true, "compiled_code": "WITH fct AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_aux AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_aux\"\n),\n\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT \n    fct.publication_date,\n    fct.vacancies,\n    aux.experience_required,\n    occ.occupation,\n    occ.occupation_group,\n    occ.occupation_field\nFROM fct\nJOIN dim_aux aux ON aux.auxiliary_attributes_id = fct.aux_id\nJOIN dim_occupation occ ON occ.occupation_id = fct.occupation_id", "relation_name": "\"job_ads\".\"marts\".\"mart_occupation_trends_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.991319Z", "completed_at": "2025-05-26T11:22:58.993322Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.993822Z", "completed_at": "2025-05-26T11:22:58.993822Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035393238067626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_occupation_vacancy_totals", "compiled": true, "compiled_code": "WITH fct_job_ads AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT\n    fct_job_ads.publication_date,\n    dim_occupation.occupation,\n    dim_occupation.occupation_group,\n    dim_occupation.occupation_field,\n    SUM(fct_job_ads.vacancies) AS total_vacancies\nFROM fct_job_ads\nJOIN dim_occupation \n    ON dim_occupation.occupation_id = fct_job_ads.occupation_id\nGROUP BY\n    fct_job_ads.publication_date,\n    dim_occupation.occupation,\n    dim_occupation.occupation_group,\n    dim_occupation.occupation_field,", "relation_name": "\"job_ads\".\"marts\".\"mart_occupation_vacancy_totals\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:58.995824Z", "completed_at": "2025-05-26T11:22:58.998826Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:58.998826Z", "completed_at": "2025-05-26T11:22:58.998826Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004003286361694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_summary", "compiled": true, "compiled_code": "WITH fct AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\n\ndim_occ AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n),\n\ndim_aux AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_aux\"\n),\n\ndim_emp AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_employer\"\n)\n\nSELECT \n    f.publication_date,\n    f.vacancies,\n    f.relevance,\n    f.application_deadline,\n\n    -- Occupation info\n    o.occupation,\n    o.occupation_group,\n    o.occupation_field,\n\n    -- Employer info\n    e.employer_name,\n    e.employer_workplace,\n    e.workplace_municipality,\n    e.workplace_region,\n\n    -- Experience + aux info\n    a.experience_required,\n    a.driver_license,\n    a.access_to_own_car\n\nFROM fct f\nLEFT JOIN dim_occ o ON f.occupation_id = o.occupation_id\nLEFT JOIN dim_aux a ON f.aux_id = a.auxiliary_attributes_id\nLEFT JOIN dim_emp e ON f.employer_id = e.employer_id", "relation_name": "\"job_ads\".\"marts\".\"mart_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:59.000863Z", "completed_at": "2025-05-26T11:22:59.004379Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:59.004882Z", "completed_at": "2025-05-26T11:22:59.004882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004522562026977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.job_market.mart_top_employers", "compiled": true, "compiled_code": "WITH fct_job_ads AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"fct_job_ads\"\n),\ndim_employer AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_employer\"\n),\ndim_occupation AS (\n    SELECT * FROM \"job_ads\".\"refined\".\"dim_occupation\"\n)\n\nSELECT\n    dim_employer.employer_name,\n    dim_employer.workplace_region,\n    dim_occupation.occupation,\n    SUM(fct_job_ads.vacancies) AS total_vacancies,\nFROM fct_job_ads \nJOIN dim_employer \n    ON dim_employer.employer_id = fct_job_ads.employer_id\nJOIN dim_occupation\n    ON dim_occupation.occupation_id = fct_job_ads.occupation_id\nGROUP BY\n    dim_employer.employer_name,\n    dim_employer.workplace_region,\n    dim_occupation.occupation,\nORDER BY total_vacancies DESC", "relation_name": "\"job_ads\".\"marts\".\"mart_top_employers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-26T11:22:59.007076Z", "completed_at": "2025-05-26T11:22:59.009742Z"}, {"name": "execute", "started_at": "2025-05-26T11:22:59.009742Z", "completed_at": "2025-05-26T11:22:59.009742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036776065826416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.job_market.test_missing_occupation_id", "compiled": true, "compiled_code": "-- Detects rows with missing occupation identifiers,\n-- which are necessary for classification and analysis.\n\nSELECT \n    * \nFROM \"job_ads\".\"refined\".\"fct_job_ads\" f \nLEFT JOIN \"job_ads\".\"refined\".\"dim_occupation\" d\n    ON f.occupation_id = d.occupation_id \nWHERE d.occupation_id IS NULL", "relation_name": null, "batch_results": null}], "elapsed_time": 0.3002738952636719, "args": {"invocation_command": "dbt docs generate", "strict_mode": false, "write_json": true, "partial_parse_file_diff": true, "require_yaml_configuration_for_mf_time_spines": false, "require_explicit_package_overrides_for_builtin_materializations": true, "empty_catalog": false, "log_path": "D:\\Daniel\\Studier\\OPA24\\Kurser\\6-AI_2_Data-engineering\\OPA24-project\\job_market\\logs", "partial_parse": true, "printer_width": 80, "exclude": [], "favor_state": false, "require_resource_names_without_spaces": false, "use_colors": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_vars": false, "print": true, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": false, "introspect": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "static_parser": true, "compile": true, "version_check": true, "defer": false, "profiles_dir": "C:\\Users\\dwahl\\.dbt", "macro_debugging": false, "use_colors_file": true, "show_resource_report": false, "log_level_file": "debug", "log_format": "default", "quiet": false, "project_dir": "D:\\Daniel\\Studier\\OPA24\\Kurser\\6-AI_2_Data-engineering\\OPA24-project\\job_market", "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "select": [], "which": "generate", "vars": {}, "static": false, "log_format_file": "debug"}}